<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="shortcut icon" href="img/favicon.png">
		<title>创建实例</title>
		<!-- Bootstrap CSS -->
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<!-- bootstrap theme -->
		<link href="css/bootstrap-theme.css" rel="stylesheet">
		<!-- font icon -->
		<link href="css/elegant-icons-style.css" rel="stylesheet" />
		<link href="css/font-awesome.min.css" rel="stylesheet" />
		<link href="css/style.css" rel="stylesheet">
		<link href="css/style-responsive.css" rel="stylesheet" />
		<link href="layui/css/layui.css" rel="stylesheet" />
		<script src="js/jquery-1.8.3.min.js"></script>
		<script src="layui/layui.js"></script>
	</head>

	<body>
		<div class="row">
			<div class="col-lg-12 col-xs-12">
				<h3 class="page-header"><i class="fa fa-laptop"></i> Home</h3>
				<ol class="breadcrumb">
					<li><i class="fa fa-home"></i>Home / 创建实例 </li>
				</ol>
			</div>
		</div>
		<div class="row">
			<div class="col-lg-12 col-xs-12">

				<div class="panel panel-default">
					<div class="panel-heading">
						<div class="panel-title">创建实例</div>
					</div>
					<div class="panel-body">
						<!-- 示例-970 -->
						<!--<ins class="adsbygoogle" style="display:inline-block;width:970px;height:90px" data-ad-client="ca-pub-6111334333458862" data-ad-slot="3820120620"></ins>-->

						<!--<fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">-->
							<!--<legend>方框风格的表单集合</legend>-->
						<!--</fieldset>-->
					<div class="layui-tab">
                      <ul class="layui-tab-title">
                        <li class="layui-this">自定义创建</li>
                        <li>模板创建</li>
                      </ul>
                      <div class="layui-tab-content">
                        <div class="layui-tab-item layui-show">
                          <form class="layui-form layui-form-pane" action="">

								<div class="layui-form-item">
								<label class="layui-form-label">实例名称</label>
								<div class="layui-input-inline">
									<input id="username" lay-verify="required" onchange="intanceNameCheck('name')" value="" placeholder="请输入" autocomplete="off" class="layui-input" type="text">
								</div><font style="display:online" id="instanceNameCheck"></font>
							</div>

							<div class="layui-form-item" style="width:300px;">
								<label class="layui-form-label">运行主机</label>
								<div class="layui-input-block">
									<select id="host" lay-filter="aihao" >
										<option value="null"></option>
										{% for k,v in data['host'].items() %}
										<option value="{{ k }}">{{ v }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="layui-form-item" style="width:300px;">
								<label class="layui-form-label">可用磁盘</label>
								<div class="layui-input-block">
									<select  id='disk' name="interest" lay-filter="aihao">
										<option value="null"></option>
										{% for k,v in data['disk'].items() %}
										<option value="{{ k }}">{{ v }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="layui-form-item" style="width:300px;">
								<label class="layui-form-label">CPU</label>
								<div class="layui-input-block">
									<select id='cpu' name="interest" lay-filter="aihao">
										<option value="null"></option>
										<option value="1">1核</option>
										<option value="2">2核</option>
										<option value="4">4核</option>
										<option value="8">8核</option>
									</select>
								</div>
							</div>
							  <div class="layui-form-item" style="width:300px;">
								<label class="layui-form-label">内存</label>
								<div class="layui-input-block">
									<select id='memory' name="interest" lay-filter="aihao">
										<option value="null"></option>
										<option value="1">1G</option>
										<option value="2">2G</option>
										<option value="4">4G</option>
										<option value="8">8G</option>
										<option value="16">16G</option>
									</select>
								</div>
							</div>
							  <div class="layui-form-item" style="width:300px;" >
								<label class="layui-form-label">系统镜像</label>
								<div id='sys' class="layui-input-block">
									<select name="interest" lay-filter="aihao">
										<option value="null"></option>
										{% for k,v in data['image'].items() %}
										<option value="{{ k }}">{{ v }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							  <div class="layui-form-item" style="width:300px">
								<label class="layui-form-label">运行网络</label>
								<div id="network" class="layui-input-block">

									<select name="interest" lay-filter="aihao">
										<option value="null"></option>
										{% for k,v in data['network'].items() %}
										<option value="{{ k }}">{{ v }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="layui-form-item layui-form-text">
								<label class="layui-form-label">备注信息</label>
								<div class="layui-input-block">
									<textarea id='info' placeholder="请输入内容" class="layui-textarea"></textarea>
								</div>
							</div>
							<div class="layui-form-item">
								<button class="layui-btn" lay-submit="" lay-filter="demo2" onclick="intanceInfoCreate()">跳转式提交</button>
							</div>
							  <script src="extjs/global.js"></script>
							  <script>
							  var action = False
							  function intanceNameCheck(com) {
							  if ( com == 'name' ) {
									var intanceName = document.getElementById("username").value;
									data = {"type":"isIntanceExits","data":{"name":intanceName}}
									f = serverConnectPost(data)
									if (f['code'] == "Y") {
										document.getElementById("instanceNameCheck").innerHTML = "该主机名已经存在";
										document.getElementById('instanceNameCheck').color='red';
										return 0
									} else {
										document.getElementById("instanceNameCheck").innerHTML = "可以创建";
										document.getElementById('instanceNameCheck').color='green';
										return 1
									}
									}
								}
								function intanceInfoCreate(){
									action = 'True'
									if ( intanceNameCheck('name') == 0 ) {
									 				action = 'False';}
										var name = document.getElementById('username').value;
										 var host = document.getElementById('host').value;
										 var disk = document.getElementById('disk').value;
										 var cpu = document.getElementById('cpu').value;
										 var memory = document.getElementById('memory').value;
										 var sys = document.getElementById('sys').value;
										 var network = document.getElementById('sys').value;
										 var info = document.getElementById('info').value;

										if ( action == 'True'){
											if ( host !== 'null' && disk !== 'null' && cpu !== 'null' && memory !== 'null' && sys !== 'null' && network !== 'null') {
												data = {"type":"createMachine","data":{"name":name,"host":host,"cpu":cpu,"memory":memory,"disk":disk,"sys":sys,"network":network,"info":info}}
												f = serverConnectPost(data)
												if ( f['code'] == 200) {
													alert('ok');
												}
											} else {
													alert("config error");
											}
										}
								}
							  </script>
						</form>
							<script>
			layui.use(['form', 'layedit', 'laydate'], function() {
				var form = layui.form,
					layer = layui.layer,
					layedit = layui.layedit,
					laydate = layui.laydate;

				//日期
				laydate.render({
					elem: '#date'
				});
				laydate.render({
					elem: '#date1'
				});

				//创建一个编辑器
				var editIndex = layedit.build('LAY_demo_editor');

				//自定义验证规则
				form.verify({
					title: function(value) {
						if(value.length < 5) {
							return '标题至少得5个字符啊';
						}
					},
					pass: [/(.+){6,12}$/, '密码必须6到12位'],
					content: function(value) {
						layedit.sync(editIndex);
					}
				});

				//监听指定开关
				form.on('switch(switchTest)', function(data) {
					layer.msg('开关checked：' + (this.checked ? 'true' : 'false'), {
						offset: '6px'
					});
					layer.tips('温馨提示：请注意开关状态的文字可以随意定义，而不仅仅是ON|OFF', data.othis)
				});

				//监听提交
				form.on('submit(demo1)', function(data) {
					layer.alert(JSON.stringify(data.field), {
						title: '最终的提交信息'
					})
					return false;
				});

			});
		</script>
                        </div>
                        <div class="layui-tab-item">
                            sfsaf
                        </div>

                      </div>
                    </div>
					</div>
				</div>
			</div>
		</div>

		<script src="js/jquery-1.8.3.min.js"></script>
		<script src="layui/layui.js"></script>
		<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
		<script>
			layui.use('element', function(){
  var $ = layui.jquery
  ,element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

  //触发事件
  var active = {
    tabAdd: function(){
      //新增一个Tab项
      element.tabAdd('demo', {
        title: '新选项'+ (Math.random()*1000|0) //用于演示
        ,content: '内容'+ (Math.random()*1000|0)
        ,id: new Date().getTime() //实际使用一般是规定好的id，这里以时间戳模拟下
      })
    }
    ,tabDelete: function(othis){
      //删除指定Tab项
      element.tabDelete('demo', '44'); //删除：“商品管理”


      othis.addClass('layui-btn-disabled');
    }
    ,tabChange: function(){
      //切换到指定Tab项
      element.tabChange('demo', '22'); //切换到：用户管理
    }
  };

  $('.site-demo-active').on('click', function(){
    var othis = $(this), type = othis.data('type');
    active[type] ? active[type].call(this, othis) : '';
  });

  //Hash地址的定位
  var layid = location.hash.replace(/^#test=/, '');
  element.tabChange('test', layid);

  element.on('tab(test)', function(elem){
    location.hash = 'test='+ $(this).attr('lay-id');
  });

});
		</script>
	</body>

</html>
